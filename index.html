<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>pc最终项目</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
<!--最外侧包裹容器-->
<div id="wrap">
    <!--t头部区域-->
    <header id="header">
        <!--头部真正承接内容区域-->
        <div class="headerMain">
            <!--左侧logo区-->
            <h1 class="log">
                <a href="javascript:;">
                    <img src="img/logo.png" alt="">
                </a>
            </h1>
            <!--右侧导航区-->
            <nav class="nav">
                <ul id="list">

                    <li class="items"><a href="javascript:;">
                        <div class="up">
                            <img src="img/home_gruen.png" alt="">
                        </div>
                        <div class="down">
                            <img src="img/home.png" alt="">
                        </div>

                    </a></li>
                    <li class="items"><a href="javascript:;">
                        <div class="up">Course</div>
                        <div class="down">Course</div>
                    </a></li>
                    <li class="items"><a href="javascript:;">
                        <div class="up">Works</div>
                        <div class="down">Works</div>
                    </a></li>
                    <li class="items"><a href="javascript:;">
                        <div class="up">About</div>
                        <div class="down">About</div>
                    </a></li>
                    <li class="items"><a href="javascript:;">
                        <div class="up">Team</div>
                        <div class="down">Team</div>
                    </a></li>
                </ul>
            </nav>
        </div>
        <div class="ceil">

        </div>
    </header>
    <section id="content">
        <ul class="itemsWrap">
            <li class="item">
                <div class="itemInner">
                    <ul id="sectionWrap">
                        <li class="sectionItem active"><div class="commonTitle">one</div></li>
                        <li class="sectionItem ">       <div class="commonTitle">two</div></li>
                        <li class="sectionItem">       <div class="commonTitle">three</div></li>
                        <li class="sectionItem">       <div class="commonTitle">four</div></li>
                    </ul>
                    <ul id="ceil">
                        <li class="ceilItem active"></li>
                        <li class="ceilItem"></li>
                        <li class="ceilItem"></li>
                        <li class="ceilItem"></li>
                    </ul>
                </div>
            </li>
            <li class="item">
                <div class="itemInner">
                    <div class="course1">
                        <p class="commonTitle">EINBLICK</p>
                        <p class="commonTitle">ERKENNTNIS</p>
                        <p class="commonTitle">ERGEBNIS</p>
                    </div>
                    <div class="course2">

                        <p class="commonText">
                            Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen.
                        </p>

                    </div>
                    <div class="course3">

                    </div>
                </div>
            </li>
            <li class="item">
                <div class="itemInner">
                    <div class="works1">
                        <p class="commonTitle">EINBLICK</p>
                        <p class="commonTitle">ERKENNTNIS</p>
                        <p class="commonTitle">ERGEBNIS</p>
                    </div>
                    <div class="works2">

                        <div class="works2Item"><img src="img/worksimg1.jpg" alt="">
                            <div class="mask"><span>这是一个图片</span>
                                <div class="icon"></div>
                            </div>

                        </div>
                        <div class="works2Item"><img src="img/worksimg2.jpg" alt="">
                            <div class="mask"><span>这是一个图片</span>
                                <div class="icon"></div>
                            </div>

                        </div>
                        <div class="works2Item"><img src="img/worksimg3.jpg" alt="">
                            <div class="mask"><span>这是一个图片</span>
                                <div class="icon"></div>
                            </div>

                        </div>
                        <div class="works2Item"><img src="img/worksimg4.jpg" alt="">
                            <div class="mask"><span>这是一个图片</span>
                                <div class="icon"></div>
                            </div>

                        </div>

                    </div>
                    <div class="robote">

                    </div>
                    <div class="works3"></div>
                </div>
            </li>
            <li class="item">
                <div class="itemInner">
                    <div class="about1">
                        <p class="commonTitle">EINBLICK</p>
                        <p class="commonTitle">ERKENNTNIS</p>
                        <p class="commonTitle">ERGEBNIS</p>
                    </div>
                    <div class="about2">

                        <p class="commonText">
                            Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen.
                        </p>

                    </div>
                    <div class="about3">
                        <!--两张效果图-->
                        <div class="imgWrap" id="imgWrap1">

                            <div class="mask">
                                <div class="maskItem"><img src="img/about1.jpg" alt=""></div>
                                <div class="maskItem"><img src="img/about1.jpg" alt=""></div>
                                <div class="maskItem"><img src="img/about1.jpg" alt=""></div>
                                <div class="maskItem"><img src="img/about1.jpg" alt=""></div>
                            </div>

                        </div>
                        <div class="imgWrap" id="imgWrap2">


                            <div class="mask">
                                <div class="maskItem"><img src="img/about3.jpg" alt=""></div>
                                <div class="maskItem"><img src="img/about3.jpg" alt=""></div>
                                <div class="maskItem"><img src="img/about3.jpg" alt=""></div>
                                <div class="maskItem"><img src="img/about3.jpg" alt=""></div>
                            </div>

                        </div>

                    </div>
                </div>
            </li>
            <li class="item">
                <div class="itemInner">
                    <div class="team1">
                        <p class="commonTitle">EINBLICK</p>
                        <p class="commonTitle">ERKENNTNIS</p>
                    </div>
                    <div class="team2">
                        <p class="commonText">
                            Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen.
                        </p>
                    </div>
                    <div class="team3">
                        <ul class="team3List">
                            <li class="team3Iteme">
                                <canvas></canvas>
                            </li>
                            <li class="team3Iteme">
                                <canvas></canvas>
                            </li>
                            <li class="team3Iteme">
                                <canvas></canvas>
                            </li>
                            <li class="team3Iteme">
                                <canvas></canvas>
                            </li>
                        </ul>
                    </div>
                </div>
            </li>
        </ul>
        <ul id="aticel">
            <li class="active"></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </section>
</div>
<script type="text/javascript">
    window.onload = function () {
        //获取所有的up
        var navUp = document.querySelectorAll('#header .headerMain #list .items .up');
        var items = document.querySelectorAll('#header .headerMain #list .items');
        var arrow = document.querySelector('#header .ceil');
        var content = document.getElementById('content');
        var header = document.getElementById('header')
        var liNodes = document.querySelectorAll('#content .itemsWrap .item');
        var itemWrap = document.querySelector('#content .itemsWrap');
        //获取couser3
        var course3 = document.querySelector('#content .itemsWrap .item .itemInner .course3');
        var index = 0;
        var timer = null;
        //初始化 元素的位置
        navUp[0].style.width = '100%'

        console.log(navUp[0].offsetLeft)

        navMove();
        function navMove() {
           for (var i = 0; i < items.length; i++) {
//        var items = items[i];
               items[i].index = i;
               items[i].onclick = function () {
                   index = this.index
                   arroConChange(this.index)
               }
           }
       }

        //改变三角 以及内容的位置
        function arroConChange(index) {


            for (var j = 0; j < liNodes.length; j++) {
                liNodes1[j].className = ''


            }

            liNodes1[index].className = 'active'



            arrow.style.left = items[index].getBoundingClientRect().left + items[index].offsetWidth / 2 + 'px';
            for (var i = 0; i < navUp.length; i++) {
                navUp[i].style.width = ''

            }
            navUp[index].style.width = '100%'
            itemWrap.style.top = -(index) * (document.documentElement.clientHeight - header.offsetHeight) + 'px';

        }

        heightSet();
        function heightSet() {
            //设置高度
            arrow.style.left = items[0].getBoundingClientRect().left + items[0].offsetWidth / 2 + 'px';
            content.style.height = document.documentElement.clientHeight - header.offsetHeight + 'px';

            for (var i = 0; i < liNodes.length; i++) {
                liNodes[i].style.height = document.documentElement.clientHeight - header.offsetHeight + 'px';

            }
        }

        window.onresize = function () {
            heightSet()
            arroConChange(index)
        }
        //滚轮事件
        Scroll()


        var liNodes1 = document.querySelectorAll('#aticel li');
        var temp = 0;
    smallCeil()
      function smallCeil() {
          for (var i = 0; i < liNodes1.length; i++) {
              liNodes1[i].index = i;
              liNodes1[i].onclick = function () {
                  for (var j = 0; j < liNodes.length; j++) {
                      liNodes1[j].className = ''

                  }
                  arroConChange(this.index)
                  this.className = 'active'
                  index = this.index

              }
          }
      }

        function Scroll() {
//            for (var i = 0; i < liNodes1.length; i++) {
//                liNodes1[i].className = ''
//            }
//            liNodes1[temp].className = 'active'
//            temp++
            //ie/chrome
            document.onmousewheel = function (e) {
                clearTimeout(timer)
                timer = setTimeout(function () {
                    scrollMove(e)
                },200)
            };
            //firefox
            if(document.addEventListener){
                document.addEventListener('DOMMouseScroll',scrollMove);
            }

            function scrollMove(event) {
                event = event || window.event;
                var flag = '';
                if(event.wheelDelta){
                    //ie/chrome
                    if(event.wheelDelta > 0){
                        //上
                        flag = 'up';
                    }else {
                        //下
                        flag = 'down'
                    }
                }
                else if(event.detail){
                    //firefox
                    if(event.detail < 0){
                        //上
                        flag = 'up';
                    }else {
                        //下
                        flag = 'down'
                    }
                }

                switch (flag){
                    case 'up':
                        //鼠标滚轮向上滚动
                        console.log('上')
                        if(index>0){
                            index--
//                            return
                            arroConChange(index)
                        }

                        break;
                    case 'down':
                        //鼠标滚轮向下滚动
                        console.log('下')
                        if(items.length-1){
                            index++
                            arroConChange(index)
                        }

                        break;
                }

                //取消默认行为
                event.preventDefault && event.preventDefault();
                return false;
            }
        }





      //  动态创建 li 在course3内部
        for (var i = 0; i < 12; i++) {
            var font = document.createElement('div');
            var back = document.createElement('div');
            var divNodes = document.createElement('div');
            divNodes.className = 'line';
            divNodes.backgroundColor = 'red';
            font.className = 'font';
            back.innerHTML = '看啥啊啊';
            back.className = 'back';
            divNodes.appendChild(font);
            divNodes.appendChild(back);
            course3.appendChild(divNodes);

        }
        var num = 1
       setTimeout(function () {
           var line = document.querySelectorAll('.line')
           for (var i = 0; i < line.length; i++) {



               line[i].onmouseover = function () {
                   num++
                   this.style.transform = 'rotateY(180deg)'
//                   alert(1)

               }
               line[i].onmouseout = function () {
                   num++
                   this.style.transform = 'rotateY(360deg)'
//                   alert(1)

               }

           }

       },100)

        var oldIndex = 0;
        var sectionNodes = document.querySelectorAll('#sectionWrap .sectionItem');
        var ceilItems = document.querySelectorAll('#ceil .ceilItem');
        var isChanged = false;


        for (var i = 0; i < ceilItems.length; i++) {
            ceilItems[i].index = i;
            ceilItems[i].onclick = function () {

                if(isChanged){
                    return
                }
                isChanged = true;
                setTimeout(function () {
                    isChanged = false
                },3000)
                for (var j = 0; j < ceilItems.length; j++) {
                    ceilItems[j].className = 'ceilItem'

                }
                this.className = 'ceilItem active';

                if(this.index>oldIndex){
                    sectionNodes[oldIndex].className = 'sectionItem leftHidden'
                    sectionNodes[this.index].className ='sectionItem rightShow'


                }else if(this.index<oldIndex){
                    sectionNodes[oldIndex].className = 'sectionItem rightHidden'
                    sectionNodes[this.index].className ='sectionItem leftShow'
                }



                oldIndex = this.index
            }
        }

        setInterval(function () {

            if(isChanged){
                return
            }
            isChanged = true;
            setTimeout(function () {
                isChanged = false
            },3000)

            if(oldIndex>3){
                oldIndex = 0
            }
           sectionNodes[oldIndex].className = 'sectionItem leftHidden'
//            sectionNodes[oldIndex+1].className ='sectionItem rightShow'

            sectionNodes[oldIndex].className = 'sectionItem leftHidden'
            sectionNodes[oldIndex+1>3? 0:oldIndex+1].className ='sectionItem rightShow'

            for (var j = 0; j < ceilItems.length; j++) {
                ceilItems[j].className = 'ceilItem'

            }
            ceilItems[oldIndex+1>3? 0:oldIndex+1].className = 'ceilItem active';


            oldIndex++
        },4000)

        var team3Items = document.querySelectorAll('#content .itemsWrap .item .itemInner .team3 .team3Iteme');
        var canvas = document.querySelectorAll('#content .itemsWrap .item .itemInner .team3 .team3Iteme canvas');
        var ctx = [];
        var timer1  = null;
        var timer2 = null;
        for (var i = 0; i < canvas.length; i++) {
            canvas[i].width = 236
            canvas[i].height = 448
            ctx[i] = canvas[i].getContext('2d')

        }

        for (var i = 0; i < team3Items.length; i++) {
            team3Items[i].index = i;
            team3Items[i].onmouseover = function (e) {

                canvas[this.index].style.display = 'block'


                poll(canvas[this.index],ctx[this.index])
                this.style.opacity = 1
                e.stopPropagation()
            }
            team3Items[i].onmouseout = function () {
                canvas[this.index].style.display = 'none'


                clearInterval(timer1)
                clearInterval(timer2)
                poll(canvas[this.index],ctx[this.index],3)
                this.style.opacity = 0.3

            }

        }


        console.log(ctx)
        console.log(canvas)









//        poll(canvas[1],ctx[1])
//        poll(canvas[2],ctx[2])
//        poll(canvas[3],ctx[3])
        function poll(myCanvas,ctx,clear) {

        if(arguments.length>2&&clear){
            ctx.clearRect(0,0,myCanvas.width,myCanvas.height)
        }else{
            var arr = [];


            timer1 = setInterval(function () {
                ctx.clearRect(0,0,myCanvas.width,myCanvas.height)

                for (var i = 0; i < arr.length; i++) {
                    arr[i].deg++;
                    if(arr[i].y<0){
                        arr.splice(i,1)
                    }

                    ctx.beginPath()
                    arr[i].x = arr[i].startX+Math.sin(arr[i].deg*Math.PI/180)*arr[i].randomScale*0.8
                    arr[i].y = arr[i].startY - (arr[i].deg*Math.PI/180)*arr[i].randomScale*5

//            arr[i].r++
//            arr[i].a-=0.01
                    ctx.arc(arr[i].x,arr[i].y,arr[i].r,0,2*Math.PI)
                    ctx.fillStyle = 'rgba('+ arr[i].red+','+ arr[i].green +','+ arr[i].blue +','+ arr[i].a +')'
                    ctx.fill()

                }


            },16)



            timer2 =  setInterval(function () {

                var obj = {};
                obj.x = Math.floor(Math.random()*myCanvas.width);
//        obj.y = Math.floor(Math.random()*myCanvas.height);
                obj.y = myCanvas.height
                obj.r = Math.random()*10;
                obj.red = Math.floor(Math.random()*255);
                obj.green = Math.floor(Math.random()*255);
                obj.blue = Math.floor(Math.random()*255);
                obj.a = 1;
                obj.startX = obj.x;
                obj.startY = obj.y;
                obj.deg = 0;
                obj.randomScale = parseInt(Math.random()*80+20)

                arr.push(obj)
            },16)

            setInterval(function () {

                console.log(arr)

            },500)
        }



        }




    }



</script>
</body>
</html>